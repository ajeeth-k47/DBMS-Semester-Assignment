1.Query to fetch frequently purchased category by a customer

SELECT
    customer.first_name,
    customer.last_name,
    customer.home_address,
    category.category_name,
    category.category_id,
    count(*) as 'No_of_time_purchased'
FROM customer
INNER JOIN orders
ON customer.customer_id = orders.customer_id
INNER JOIN sales
ON sales.order_id = orders.order_id
INNER JOIN products
ON sales.product_id = products.product_id
INNER JOIN category
ON products.category_id=category.category_id
WHERE customer.customer_id=1005
GROUP BY category.category_name, category.category_id
order by  No_of_time_purchased desc LIMIT 1;


2.Query to fetch the category with highest quantity that is purchased by a customer

SELECT
    customer.first_name,
    customer.last_name,
    customer.home_address,
    category.category_name,
    category.category_id,
    SUM(sales.quantity) as 'No_of_quantity_purchased'
FROM customer
INNER JOIN orders
ON customer.customer_id = orders.customer_id
INNER JOIN sales
ON sales.order_id = orders.order_id
INNER JOIN products
ON sales.product_id = products.product_id
INNER JOIN category
ON products.category_id=category.category_id
WHERE customer.customer_id=1005
GROUP BY category.category_name, category.category_id
order by  No_of_quantity_purchased desc;


3.Query to fetch category for which the customer spend lot of money

SELECT
    customer.first_name,
    customer.last_name,
    customer.gender,
    customer.home_address,
    category.category_name,
    category.category_id,
    SUM(sales.total_price) as 'Total_Purchase_Price_For_EachCategory'
FROM customer
INNER JOIN orders
ON customer.customer_id = orders.customer_id
INNER JOIN sales
ON sales.order_id = orders.order_id
INNER JOIN products
ON sales.product_id = products.product_id
INNER JOIN category
ON products.category_id=category.category_id
WHERE customer.customer_id=1005
GROUP BY category.category_name, category.category_id
ORDER BY Total_Purchase_Price_For_EachCategory DESC LIMIT 1;


4.Query to fetch the total amount of quantity purchased per category by all customers in a state

SELECT
    customer.state,
    category.category_name,
    SUM(sales.quantity) as "Total_Quantity",
    COUNT(*) as "CountOfEachCategory_inEachState"
FROM customer
INNER JOIN orders
ON customer.customer_id = orders.customer_id
INNER JOIN sales
ON sales.order_id = orders.order_id
INNER JOIN products
ON sales.product_id = products.product_id
INNER JOIN category
ON products.category_id=category.category_id
GROUP BY category.category_name, customer.state
ORDER BY customer.state ASC,Total_Quantity DESC;


5.Query to fetch no of quantity purchased by age group for each category

SELECT
    customer.age,
    category.category_name,
    SUM(sales.quantity) as "Total_Quantity",
    COUNT(*) as "Count_of_each_category_ineachage"
FROM customer
INNER JOIN orders
ON customer.customer_id = orders.customer_id
INNER JOIN sales
ON sales.order_id = orders.order_id
INNER JOIN products
ON sales.product_id = products.product_id
INNER JOIN category
ON products.category_id=category.category_id
GROUP BY category.category_name, customer.age
ORDER BY customer.age ASC,Total_Quantity DESC;


